#!/usr/bin/env sh
set -eu

if [ "${SKIP_WEB_LINT:-}" = "1" ]; then
  echo "pre-commit: skipping web lint (SKIP_WEB_LINT=1)"
  exit 0
fi

if [ -f "web/package.json" ]; then
  echo "pre-commit: running web lint"
  npm --prefix web run lint
else
  echo "pre-commit: web/package.json not found; skipping web lint"
fi

if [ "${SKIP_BACKEND_LINT:-}" = "1" ]; then
  echo "pre-commit: skipping backend lint (SKIP_BACKEND_LINT=1)"
  exit 0
fi

if [ -f "docker-compose.ci.yml" ]; then
  echo "pre-commit: running backend ruff via docker compose"
  docker compose -f docker-compose.ci.yml exec -T backend ruff check
else
  echo "pre-commit: docker-compose.ci.yml not found; skipping backend lint"
fi
